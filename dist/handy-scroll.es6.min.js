/*!
handy-scroll v1.0.2
https://amphiluke.github.io/handy-scroll/
(c) 2018 Amphiluke
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.handyScroll=t()}(this,function(){"use strict";let e=Array.prototype.slice,t=document,i={doc:t,html:t.documentElement,body:t.body,$:e=>"string"==typeof e?i.body.querySelector(e):e,$$:t=>Array.isArray(t)?t:t.nodeType===Node.ELEMENT_NODE?[t]:"string"==typeof t?e.call(i.body.querySelectorAll(t)):e.call(t)},n={init(e){let t=this,n=i.$$(".handy-scroll-body").filter(t=>t.contains(e));n.length&&(t.scrollBody=n[0]),t.container=e,t.visible=!0,t.initWidget(),t.update(),t.syncWidget(),t.addEventHandlers()},initWidget(){let e=this.widget=i.doc.createElement("div");e.classList.add("handy-scroll");let t=i.doc.createElement("div");t.style.width=`${this.container.scrollWidth}px`,e.appendChild(t),this.container.appendChild(e)},addEventHandlers(){let e=this;(e.eventHandlers=[{el:e.scrollBody||window,handlers:{scroll(){e.checkVisibility()},resize(){e.update()}}},{el:e.widget,handlers:{scroll(){e.visible&&e.syncContainer(!0)}}},{el:e.container,handlers:{scroll(){e.syncWidget(!0)},focusin(){setTimeout(()=>e.syncWidget(),0)}}}]).forEach(({el:e,handlers:t})=>{Object.keys(t).forEach(i=>e.addEventListener(i,t[i],!1))})},checkVisibility(){let e=this,{widget:t,container:n,scrollBody:l}=e,o=t.scrollWidth<=t.offsetWidth;if(!o){let e=n.getBoundingClientRect(),t=l?l.getBoundingClientRect().bottom:window.innerHeight||i.html.clientHeight;o=e.bottom<=t||e.top>t}e.visible===o&&(e.visible=!o,t.classList.toggle("handy-scroll-hidden"))},syncContainer(e=!1){let t=this;!0!==t.skipSyncContainer?(t.skipSyncWidget=e,t.container.scrollLeft=t.widget.scrollLeft):t.skipSyncContainer=!1},syncWidget(e=!1){let t=this;!0!==t.skipSyncWidget?(t.skipSyncContainer=e,t.widget.scrollLeft=t.container.scrollLeft):t.skipSyncWidget=!1},update(){let{widget:e,container:t,scrollBody:i}=this;e.style.width=`${t.clientWidth}px`,i||(e.style.left=`${t.getBoundingClientRect().left}px`),e.firstElementChild.style.width=`${t.scrollWidth}px`,this.syncWidget(),this.checkVisibility()},destroy(){this.eventHandlers.forEach(({el:e,handlers:t})=>{Object.keys(t).forEach(i=>e.removeEventListener(i,t[i],!1))}),this.widget.parentNode.removeChild(this.widget),this.eventHandlers=this.widget=this.container=this.scrollBody=null}},l=[],o={mount(e){i.$$(e).forEach(e=>{if(o.mounted(e))return;let t=Object.create(n);l.push(t),t.init(e)})},mounted(e){let t=i.$(e);return l.some(e=>e.container===t)},update(e){i.$$(e).forEach(e=>{l.some(t=>t.container===e&&(t.update(),!0))})},destroy(e){i.$$(e).forEach(e=>{l.some((t,i)=>t.container===e&&(l.splice(i,1)[0].destroy(),!0))})}};function d(){o.mount("[data-handy-scroll]")}return"loading"===i.doc.readyState?i.doc.addEventListener("DOMContentLoaded",d,!1):d(),o});
